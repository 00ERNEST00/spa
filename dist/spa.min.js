/*!
 * SPA v0.2.0
 * A webapp framework for routing control and view transitions
 * Copyright 2013 zhaoda <http://zhaoda.net>
 * Licensed under MIT https://raw.github.com/zhaoda/spa/master/LICENSE
 */

!function(a){"use strict";function b(a){return a=a||l.href,a.replace(/^[^#]*#?\/?(.*)\/?$/,"$1")}function c(a){return"[object RegExp]"==toString.call(a)}function d(a){return a=a.replace(x,"\\$&").replace(u,"(?:$1)?").replace(v,function(a,b){return b?a:"([^/]+)"}).replace(w,"(.*?)"),"^"+a+"$"}function e(b,c){var d=b.exec(c).slice(1),e=[];return a.each(d,function(a,b){b&&e.push(decodeURIComponent(b))}),e}function f(a,b){a.data("prevPage.spa")&&a.data("prevPage.spa").css({zIndex:n}),b.data("prevPage.spa")&&b.data("prevPage.spa").css({zIndex:n}),a.css({zIndex:o}),b.css({zIndex:p})}function g(b,c,d,e){a(".spa-page-body",b),a(".spa-page-body",c);A[d]||(d="defaultInOut"),z[d].apply(b,[b,c,e])}function h(){event.stopPropagation(),event.preventDefault()}var i,j=a(window),k=a(document),l=window.location,m=window.history,n=2e3,o=2001,p=2002,q=0,r="body { position: relative; margin: 0; padding: 0; width: 100%; overflow: hidden; }        .spa-fullscreen {position: absolute; left: 0; top: 0; margin: 0; padding: 0; width: 100%; visibility: hidden; overflow: hidden; z-index: -1; }        .spa-page {position: absolute; left: 0; top: 0; bottom: 0; right: 0; margin: 0; padding: 0; overflow: hidden; z-index: 2000; }        .spa-page-bg {position: absolute; left: 0; top: 0; bottom: 0; right: 0; margin: 0; padding: 0; }        .spa-page-body {position: absolute; left: 0; top: 0; bottom: 0; right: 0; margin: 0; padding: 0; overflow: hidden; }        .spa-scroll {overflow: auto; -webkit-overflow-scrolling: touch; -moz-overflow-scrolling: touch; -ms-overflow-scrolling: touch; -o-overflow-scrolling: touch; overflow-scrolling: touch; }        .spa-scroll-x {overflow-y: hidden;}        .spa-scroll-y {overflow-x: hidden;}        .spa-cover {position: absolute; left: 0; right: 0; top: 0; bottom: 0; text-align: center; z-index: 5000; }        .spa-loader {position: absolute; left: 0; right: 0; top: 0; bottom: 0; text-align: center; overflow: hidden; z-index: 5001; }",s='<div class="spa-loader-animate"><span></span><span></span><span></span></div>',t=".spa-loader .spa-loader-animate {position: absolute; left: 50%; top: 50%; margin: -12px 0 0 -65px; }        .spa-loader .spa-loader-animate span { display: inline-block; vertical-align: middle; width: 10px; height: 10px; margin: 0 10px; background: black; border-radius: 50px; -webkit-animation: loader 0.9s infinite alternate; -moz-animation: loader 0.9s infinite alternate; }        .spa-loader .spa-loader-animate span:nth-of-type(2) { -webkit-animation-delay: 0.3s; -moz-animation-delay: 0.3s; }        .spa-loader .spa-loader-animate span:nth-of-type(3) { -webkit-animation-delay: 0.6s; -moz-animation-delay: 0.6s; }        @-webkit-keyframes loader {          0% { width: 10px; height: 10px; opacity: 0.8; -webkit-transform: translateY(0); }          100% { width: 24px; height: 24px; opacity: 0.1; -webkit-transform: translateY(-21px); }        }        @-moz-keyframes loader {          0% { width: 10px; height: 10px; opacity: 0.8; -moz-transform: translateY(0); }          100% { width: 24px; height: 24px; opacity: 0.1; -moz-transform: translateY(-21px);}}";k.on("addstyle.spa",function(b,c){a('<style type="text/css">'+c+"</style>").appendTo(a("head"))}),j.on("adjustfullscreen.spa resize orientationchange",function(b){function c(){var b=d.data("$fullscreen"),c=Math.max(j.height(),window.innerHeight),e=Math.max(j.width(),window.innerWidth);b||(b=a('<div class="spa-fullscreen"></div>').prependTo(i),d.data("$fullscreen",b)),b.css({height:2*c}),window.scrollTo(0,0),j.data("innerHeight")||j.data({innerHeight:window.innerHeight}),c=Math.max(j.height(),window.innerHeight),b.height()!=c&&(i.css({width:e,height:c}),b.css({width:e,height:c}))}var d=a(b.currentTarget),e=d.data("adjustfullscreenRequestID");e?(cancelAnimationFrame(e),d.removeData("adjustfullscreenRequestID")):d.data("fullpageRequestID",requestAnimationFrame(function(){c()}))}),k.on("scroll.spa",function(b,c){var d=a(b.target),e=c&&c.direction||"";d.addClass("spa-scroll"+(e?" spa-scroll-"+e:""))}),k.on("touchstart",".spa-scroll, .spa-scroll-x, .spa-scroll-y",function(b){var c=a(b.currentTarget),d=c.scrollTop(),e=c.scrollLeft(),f=c.innerHeight(),g=c.innerWidth(),h=c.prop("scrollHeight"),i=c.prop("scrollWidth");(c.hasClass("spa-scroll")||c.hasClass("spa-scroll-x"))&&(0>=e&&c.scrollLeft(1),e+g>=i&&c.scrollLeft(i-g-1)),(c.hasClass("spa-scroll")||c.hasClass("spa-scroll-y"))&&(0>=d&&c.scrollTop(1),d+f>=h&&c.scrollTop(d-1))}),j.on("scroll",function(){var a=j.data("innerHeight");a&&a!=window.innerHeight&&j.trigger("adjustfullscreen.spa")}),j.on("popstate",function(a){if(k.data("boot.spa")){var c=j.data("cover.spa"),d=j.data("cover.spa");if(c&&"block"==c.css("display")||d&&"block"==d.css("display"))return!1;var e=j.data("curPage.spa");if(e&&e.hasClass("spa-panel")){var f=e.data("prevPage.spa");return f.trigger("openpage.spa"),!1}var g=j.data("hashhistory.spa")||[],h=b();if(!g.length||g[g.length-1]!=h){g.push(h),j.data("hashhistory.spa",g);var i=j.data("pagescache.spa")||{},l=i[h],m=a.state||{};j.data("pushData.spa")&&(m=j.data("pushData.spa"),j.data("pushData.spa",null)),l?(l.data("oldpushData.spa",l.data("pushData.spa")),l.data("pushData.spa",m),l.trigger("openpage.spa")):k.trigger("createpage.spa",{hash:h,pushData:m})}}});var u=/\((.*?)\)/g,v=/(\(\?)?:\w+/g,w=/\*\w+/g,x=/[\-{}\[\]+?.,\\\^$|#\s]/g,y={route:"",animate:"",classname:"",view:function(){return{title:"",body:""}},init:function(){},beforeopen:function(){},afteropen:function(){},beforeclose:function(){},afterclose:function(){}};k.on("route.spa",function(b,e){var f=Array.prototype.slice.call(arguments,1);if(f.length>1)return a.each(f,function(a,b){k.trigger("route.spa",b)}),!1;var g=j.data("routes.spa")||{},h=e.route||"";c(h)||(h=d(h)),e.animate&&!a.isFunction(e.animate)&&B(e.animate)&&(e.animate=""),g[h]=a.extend({},y,e),j.data("routes.spa",g)});var z={},A={};z.defaultInOut=function(a,b,c){f(b,a),c()},k.on("addTransitPageAnimates.spa",function(b,c){var d=[];a.each(c,function(a){d.push(a)}),a.each(d,function(a,b){A[b]=a%2===0?d[a+1]:d[a-1]}),a.extend(z,c)}),k.trigger("addTransitPageAnimates.spa",{fadeIn:function(b,c,d){{var e=a(".spa-page-body",b);a(".spa-page-body",c)}f(c,b),e.css({opacity:0}).transition({opacity:1},function(){d()})},fadeOut:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c));e.transition({opacity:0},function(){e.css({opacity:1}),f(c,b),d()})},fadeInLeft:function(b,c,d){{var e=a(".spa-page-body",b);a(".spa-page-body",c)}f(c,b),e.css({x:"100%",opacity:0}).transition({x:"0",opacity:1},function(){d()})},fadeOutRight:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c));e.transition({x:"100%",opacity:0},function(){e.css({x:0,opacity:1}),f(c,b),d()})},fadeInRight:function(b,c,d){{var e=a(".spa-page-body",b);a(".spa-page-body",c)}f(c,b),e.css({x:"-100%",opacity:0}).transition({x:"0",opacity:1},function(){d()})},fadeOutLeft:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c));e.transition({x:"-100%",opacity:0},function(){e.css({x:0,opacity:1}),f(c,b),d()})},fadeInUp:function(b,c,d){{var e=a(".spa-page-body",b);a(".spa-page-body",c)}f(c,b),e.css({y:"100%",opacity:0}).transition({y:"0",opacity:1},function(){d()})},fadeOutDown:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c));e.transition({y:"100%",opacity:0},function(){e.css({y:0,opacity:1}),f(c,b),d()})},fadeInDown:function(b,c,d){{var e=a(".spa-page-body",b);a(".spa-page-body",c)}f(c,b),e.css({y:"-100%",opacity:0}).transition({y:"0",opacity:1},function(){d()})},fadeOutUp:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c));e.transition({y:"-100%",opacity:0},function(){e.css({y:0,opacity:1}),f(c,b),d()})},slideInLeft:function(b,c,d){{var e=a(".spa-page-body",b);a(".spa-page-body",c)}f(c,b),e.css({x:"100%"}).transition({x:"0"},function(){d()})},slideOutRight:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c));e.transition({x:"100%"},function(){e.css({x:0}),f(c,b),d()})},slideInRight:function(b,c,d){{var e=a(".spa-page-body",b);a(".spa-page-body",c)}f(c,b),e.css({x:"-100%"}).transition({x:"0"},function(){d()})},slideOutLeft:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c));e.transition({x:"-100%"},function(){e.css({x:0}),f(c,b),d()})},slideInUp:function(b,c,d){{var e=a(".spa-page-body",b);a(".spa-page-body",c)}f(c,b),e.css({y:"100%"}).transition({y:"0"},function(){d()})},slideOutDown:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c));e.transition({y:"100%"},function(){e.css({y:0}),f(c,b),d()})},slideInDown:function(b,c,d){{var e=a(".spa-page-body",b);a(".spa-page-body",c)}f(c,b),e.css({y:"-100%"}).transition({y:"0"},function(){d()})},slideOutUp:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c));e.transition({y:"-100%"},function(){e.css({y:0}),f(c,b),d()})},pushInLeft:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=0;f(c,b),e.css({x:"100%"}).transition({x:"0"},function(){2==++h&&d()}),g.transition({x:"-100%"},function(){g.css({x:0}),2==++h&&d()})},pushOutRight:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=0;f(c,b),g.transition({x:"100%"},function(){g.css({x:0}),2==++h&&d()}),e.css({x:"-100%"}).transition({x:"0"},function(){2==++h&&d()})},pushInRight:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=0;f(c,b),g.transition({x:"100%"},function(){g.css({x:0}),2==++h&&d()}),e.css({x:"-100%"}).transition({x:"0"},function(){2==++h&&d()})},pushOutLeft:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=0;f(c,b),g.transition({x:"-100%"},function(){g.css({x:0}),2==++h&&d()}),e.css({x:"100%"}).transition({x:"0"},function(){2==++h&&d()})},pushInUp:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=0;f(c,b),g.transition({y:"-100%"},function(){g.css({y:0}),2==++h&&d()}),e.css({y:"100%"}).transition({y:"0"},function(){2==++h&&d()})},pushOutDown:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=0;f(c,b),g.transition({y:"100%"},function(){g.css({y:0}),2==++h&&d()}),e.css({y:"-100%"}).transition({y:"0"},function(){2==++h&&d()})},pushInDown:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=0;f(c,b),g.transition({y:"100%"},function(){g.css({y:0}),2==++h&&d()}),e.css({y:"-100%"}).transition({y:"0"},function(){2==++h&&d()})},pushOutUp:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=0;f(c,b),g.transition({y:"-100%"},function(){g.css({y:0}),2==++h&&d()}),e.css({y:"100%"}).transition({y:"0"},function(){2==++h&&d()})},zoomIn:function(b,c,d){{var e=a(".spa-page-body",b);a(".spa-page-body",c)}f(c,b),e.css({scale:0}).transition({scale:1},function(){d()})},zoomOut:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c));e.transition({scale:0},function(){e.css({scale:1}),f(c,b),d()})},overlayInLeft:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),e.children().width());f(c,b),e.css({left:"auto",width:g}),g=2*g-e.prop("clientWidth"),e.css({width:g,x:g}).transition({x:0},function(){d()})},overlayOutRight:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g=e.width();e.transition({x:g},function(){e.css({width:"auto",left:0,x:0}),f(c,b),d()})},overlayInRight:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),e.children().width());f(c,b),e.css({right:"auto",width:g}),g=2*g-e.prop("clientWidth"),e.css({width:g,x:0-g}).transition({x:0},function(){d()})},overlayOutLeft:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g=e.width();e.transition({x:0-g},function(){e.css({width:"auto",right:0,x:0}),f(c,b),d()})},overlayInUp:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),e.children().height());f(c,b),e.css({top:"auto",height:g}),g=2*g-e.prop("clientHeight"),e.css({height:g,y:g}).transition({y:0},function(){d()})},overlayOutDown:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g=e.height();e.transition({y:g},function(){e.css({height:"auto",top:0,y:0}),f(c,b),d()})},overlayInDown:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),e.children().height());f(c,b),e.css({bottom:"auto",height:g}),g=2*g-e.prop("clientHeight"),e.css({height:g,y:0-g}).transition({y:0},function(){d()})},overlayOutUp:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g=e.height();e.transition({y:0-g},function(){e.css({height:"auto",bottom:0,y:0}),f(c,b),d()})},revealInLeft:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=e.children().width();f(b,c),e.css({left:"auto",width:h}),h=2*e.width()-e.prop("clientWidth"),e.css({width:h}),g.transition({x:0-h},function(){f(c,b),d()})},revealOutRight:function(b,c,d){{var e=a(".spa-page-body",b),g=a(".spa-page-body",c);g.width()}f(c,b),e.transition({x:0},function(){g.css({width:"auto",left:0}),d()})},revealInRight:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=e.children().width();f(b,c),e.css({right:"auto",width:h}),h=2*e.width()-e.prop("clientWidth"),e.css({width:h}),g.transition({x:h},function(){f(c,b),d()})},revealOutLeft:function(b,c,d){{var e=a(".spa-page-body",b),g=a(".spa-page-body",c);g.width()}f(c,b),e.transition({x:0},function(){g.css({width:"auto",right:0}),d()})},revealInUp:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=e.children().height();f(b,c),e.css({top:"auto",height:h}),h=2*e.height()-e.prop("clientHeight"),e.css({height:h}),g.transition({y:0-h},function(){f(c,b),d()})},revealOutDown:function(b,c,d){{var e=a(".spa-page-body",b),g=a(".spa-page-body",c);g.height()}f(c,b),e.transition({y:0},function(){g.css({height:"auto",top:0}),d()})},revealInDown:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=e.children().height();f(b,c),e.css({bottom:"auto",height:h}),h=2*e.height()-e.prop("clientHeight"),e.css({height:h}),g.transition({y:h},function(){f(c,b),d()})},revealOutUp:function(b,c,d){{var e=a(".spa-page-body",b),g=a(".spa-page-body",c);g.height()}f(c,b),e.transition({y:0},function(){g.css({height:"auto",bottom:0}),d()})},pushPartInLeft:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=e.children().width(),i=0;f(c,b),e.css({left:"auto",width:h}),h=2*e.width()-e.prop("clientWidth"),e.css({width:h,x:h}).transition({x:0},function(){2==++i&&d()}),g.transition({x:0-h},function(){2==++i&&d()})},pushPartOutRight:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=g.width(),i=0;f(c,b),e.transition({x:0},function(){2==++i&&d()}),g.transition({x:h},function(){g.css({width:"auto",left:0,x:0}),2==++i&&d()})},pushPartInRight:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=e.children().width(),i=0;f(c,b),e.css({right:"auto",width:h}),h=2*e.width()-e.prop("clientWidth"),e.css({width:h,x:0-h}).transition({x:0},function(){2==++i&&d()}),g.transition({x:h},function(){2==++i&&d()})},pushPartOutLeft:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=g.width(),i=0;f(c,b),e.transition({x:0},function(){2==++i&&d()}),g.transition({x:0-h},function(){g.css({width:"auto",right:0,x:0}),2==++i&&d()})},pushPartInUp:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=e.children().height(),i=0;f(c,b),e.css({top:"auto",height:h}),h=2*e.height()-e.prop("clientHeight"),e.css({height:h,y:h}).transition({y:0},function(){2==++i&&d()}),g.transition({y:0-h},function(){2==++i&&d()})},pushPartOutDown:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=g.height(),i=0;f(c,b),e.transition({y:0},function(){2==++i&&d()}),g.transition({y:h},function(){g.css({height:"auto",top:0,y:0}),2==++i&&d()})},pushPartInDown:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=e.children().height(),i=0;f(c,b),e.css({bottom:"auto",height:h}),h=2*e.height()-e.prop("clientHeight"),e.css({height:h,y:0-h}).transition({y:0},function(){2==++i&&d()}),g.transition({y:h},function(){2==++i&&d()})},pushPartOutUp:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=g.height(),i=0;f(c,b),e.transition({y:0},function(){2==++i&&d()}),g.transition({y:0-h},function(){g.css({height:"auto",bottom:0,y:0}),2==++i&&d()})}});var B=function(){var a=/^(overlay|reveal|pushPart).*$/;return function(b){return a.test(b)}}(),C=function(){var a=0;return function(){return a++}}();k.on("createpage.spa",function(b,d){k.trigger("openloader.spa");var f,g,h,i=j.data("routes.spa"),l=d.hash,m=d.pushData;if(a.each(i,function(a,b){return g=new RegExp(a),g.test(l)?(f=a,h=b,!1):(g=!1,void 0)}),c(g)){var n,o=h.classname?" spa-page-"+h.classname:"",p=a('<div class="spa-page'+o+'"><div class="spa-page-bg"></div><div class="spa-page-body"></div></div>');p.data({"hash.spa":l,"pushData.spa":m,"requestData.spa":e(g,l),"route.spa":f,"id.spa":C()}).appendTo(a("body")),k.trigger("viewcache.spa",{view:p}),n=h.view.call(p),a.isPlainObject(n)&&p.trigger("initpage.spa",n)}}),k.on("initpage.spa",".spa-page",function(b,c){var d=a(b.currentTarget);d.data("viewData.spa",c),a(".spa-page-body",d).html(c.body);var e=j.data("routes.spa"),f=e[d.data("route.spa")];a.each(["init","beforeopen","afteropen","beforeclose","afterclose"],function(a,b){c[b]&&(f[b]=c[b])}),d.show(),f.init.call(d),k.trigger("closeloader.spa"),d.trigger("openpage.spa")}),k.on("openpage.spa",".spa-page",function(c,d){var e=a(c.currentTarget),f=j.data("curPage.spa"),h=j.data("routes.spa"),i=h[e.data("route.spa")],l=e.data("hash.spa"),m=e.data("pushData.spa"),n=(e.data("oldpushData.spa"),e.data("requestData.spa"),e.data("viewData.spa")),o=m.title||n.title,p=m.animate||i.animate;if(f||(f=a('<div class="spa-page spa-page-empty"><div class="spa-page-body"></div></div>').appendTo(a("body")),j.data("curPage.spa",f)),!m.animate&&f&&f.data("prevPage.spa")&&f.data("prevPage.spa").data("id.spa")==e.data("id.spa")){var q=f.data("prevAnimate.spa");q&&!a.isFunction(q)&&(p=A[q])}var r,s;if(f.hasClass("spa-panel")){var t=j.data("panels.spa")[f.data("id.spa")];r=t.beforeclose,s=t.afterclose}else if(f.data("route.spa")){var u=h[f.data("route.spa")];r=u.beforeclose,s=u.afterclose,k.trigger("navigate.spa",{hash:l,title:o,pushData:m,replace:!0})}k.trigger("opencover.spa");var v=function(){i.afteropen.call(e),s&&s.call(f),e.data({"prevPage.spa":f}),j.data("curPage.spa",e),k.trigger("closecover.spa"),e.data("hash.spa")!=b()?j.trigger("popstate"):a.isFunction(d)&&d()};i.beforeopen.call(e),r&&r.call(f),e.data({"prevAnimate.spa":p}),a.isFunction(p)?p(e,f,v):g(e,f,p,v),k.trigger("viewcachesort.spa",{view:e})});var D={id:"",animate:"",classname:"",view:function(){return{body:""}},init:function(){},beforeopen:function(){},afteropen:function(){},beforeclose:function(){},afterclose:function(){}};k.on("panel.spa",function(b,c){var d=Array.prototype.slice.call(arguments,1);if(d.length>1)return a.each(d,function(a,b){k.trigger("panel.spa",b)}),!1;var e=j.data("panels.spa")||{};c.id&&!e[c.id]&&(e[c.id]=a.extend({},D,c),j.data("panels.spa",e))}),k.on("openpanel.spa",function(b,c,d){var e=j.data("cover.spa"),f=j.data("cover.spa");if(e&&"block"==e.css("display")||f&&"block"==f.css("display"))return!1;var h=j.data("panelscache.spa")||{},i=h[c];if(d||(d={}),i){var l=j.data("panels.spa"),m=l[c],n=j.data("curPage.spa"),o=d.animate||m.animate;if(n.hasClass("spa-panel")){var p=n.data("prevPage.spa");return p.trigger("openpage.spa",[function(){k.trigger("openpanel.spa",[c,d])}]),!1}i.data("oldpushData.spa",i.data("pushData.spa")),i.data("pushData.spa",d),k.trigger("opencover.spa"),m.beforeopen.call(i);var q=function(){m.afteropen.call(i),i.data({"prevPage.spa":n}),j.data("curPage.spa",i),k.trigger("closecover.spa")};i.data({"prevAnimate.spa":o}),a.isFunction(o)?o(i,n,q):g(i,n,o,q),k.trigger("viewcachesort.spa",{view:i})}else k.trigger("createpanel.spa",[c,d])}),k.on("closepanel.spa",function(b,c){var d=a(b.target),e=j.data("curPage.spa");if(c&&c.id&&(d=a(".spa-panel-"+c.id)),e.hasClass("spa-panel")&&e.data("id.spa")==d.data("id.spa")){var f=d.data("prevPage.spa");f.trigger("openpage.spa")}}),k.on("createpanel.spa",function(b,c,d){var e=j.data("panels.spa")||{},f=e[c];if(f){k.trigger("openloader.spa");var g,h=f.classname?" spa-panel-"+f.classname:"",i=a('<div id="spa-panel-'+c+'" class="spa-page spa-panel '+h+'"><div class="spa-page-bg"></div><div class="spa-page-body"></div></div>');i.data({"id.spa":c,"pushData.spa":d}).appendTo(a("body")),k.trigger("viewcache.spa",{view:i}),g=f.view.call(i),a.isPlainObject(g)&&i.trigger("initpanel.spa",g)}}),k.on("initpanel.spa",".spa-panel",function(b,c){var d=a(b.currentTarget),e=d.data("id.spa"),f=d.data("pushData.spa");d.data("viewData.spa",c),a(".spa-page-body",d).html(c.body);var g=j.data("panels.spa"),h=g[e];a.each(["init","beforeopen","afteropen","beforeclose","afterclose"],function(a,b){c[b]&&(h[b]=c[b])}),h.init.call(d),k.trigger("closeloader.spa"),d.trigger("openpanel.spa",[e,f])}),k.on("click touchstart",".spa-panel",function(b){var c=a(b.currentTarget),d=a(b.target);(d.hasClass("spa-page-bg")||d.hasClass("spa-panel"))&&(b.stopPropagation(),b.preventDefault(),c.trigger("closepanel.spa"))}),k.on("viewcachecount.spa",function(a,b){q=b.count}),k.on("viewcache.spa",function(b,c){var d,e,f=c.view,g=j.data("pagescache.spa")||{},h=j.data("panelscache.spa")||{},i=j.data("viewscache.spa")||[];if(f.hasClass("spa-panel")?(d="panle",e=f.data("id.spa"),h[e]=f):(d="page",e=f.data("hash.spa"),g[e]=f),i.unshift(d+":"+e),0!==q&&i.length>q){var k,l,m,n,o=i.splice(q);a.each(o,function(a,b){k=b.split(":",2),l=k[0],m=k[1],n="page"==l?g:h,n[m].html("").remove(),delete n[m]})}j.data("pagescache.spa",g),j.data("panelscache.spa",h),j.data("viewscache.spa",i)}),k.on("viewcachesort.spa",function(a,b){var c,d,e,f,g=b.view,h=j.data("viewscache.spa")||[];g.hasClass("spa-panel")?(c="panle",d=g.data("id.spa")):(c="page",d=g.data("hash.spa")),e=c+":"+d,f=h.indexOf(e),-1!==f&&(h.splice(f,1),h.unshift(e)),j.data("viewscache.spa",h)}),k.on("navigate.spa",function(b,c){var d=c.hash||"",e=c.title||"",f=c.pushData||{},g=c.replace||!1;e&&(document.title=e),d="#"+d,g?m.replaceState(f,e,d):(m.pushState(f,e,d),!a.isEmptyObject(f)&&j.data("pushData.spa",f),j.trigger("popstate"))}),k.on("opencover.spa",function(){var b=j.data("cover.spa");b||(b=a('<div class="spa-cover"></div>').appendTo(a("body")),b.on("click select mousedown mousemove mouseup touchstart touchmove touchend",h),b.trigger("scroll.spa"),j.data("cover.spa",b)),b.show()}),k.on("closecover.spa",function(){j.data("cover.spa").hide()}),k.on("loader.spa",function(a,b){b.body&&(s=b.body),b.style&&(t=b.style)}),k.on("openloader.spa",function(){var b=j.data("loader.spa");b||(k.trigger("addstyle.spa",t),b=a('<div class="spa-loader">'+s+"</div>").appendTo(a("body")),b.on("click select mousedown mousemove mouseup touchstart touchmove touchend",h),j.data("loader.spa",b)),b.show()}),k.on("closeloader.spa",function(){j.data("loader.spa").hide()}),k.on("boot.spa",function(){i=a("body"),k.trigger("addstyle.spa",r),k.trigger("adjustfullscreen.spa"),k.data("boot.spa",!0),j.trigger("popstate")})}(jQuery),function(){"use strict";for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}();