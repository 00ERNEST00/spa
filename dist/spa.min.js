/*!
 * SPA v0.3.0
 * A webapp framework for routing control and view transitions
 * Copyright 2013 zhaoda <http://zhaoda.net>
 * Licensed under MIT https://raw.github.com/zhaoda/spa/master/LICENSE
 */

!function(a){"use strict";function b(a){return a=a||p.href,a.replace(/^[^#]*#?\/?(.*)\/?$/,"$1")}function c(a){return"[object RegExp]"==toString.call(a)}function d(a){return a=a.replace(K,"\\$&").replace(H,"(?:$1)?").replace(I,function(a,b){return b?a:"([^/]+)"}).replace(J,"(.*?)"),"^"+a+"$"}function e(b,c){var d=b.exec(c).slice(1),e=[];return a.each(d,function(a,b){b&&e.push(decodeURIComponent(b))}),e}function f(a,b){var c=D[a.data("id")],d=D[b.data("id")];c&&c.prevPage&&c.prevPage.css({zIndex:w}),d.prevPage&&d.prevPage.css({zIndex:w}),a.css({zIndex:x}),b.css({zIndex:y})}function g(b,c,d,e){var f=a(".spa-page-body",b),g=(a(".spa-page-body",c),{});N[d]||(d="defaultInOut"),g.opacity=1,R(d)||(g[O]="translate3d(0, 0, 0) scale3d(1, 1, 1)"),f.css(g),M[d].apply(b,[b,c,e])}function h(){event.stopPropagation(),event.preventDefault()}var i,j,k,l,m,n=a(window),o=a(document),p=window.location,q=window.history,r=navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad)/),s=!1,t={},u={},v=[],w=2e3,x=2001,y=2002,z=0,A={},B={},C=[],D={},E="body {position: relative; margin: 0; padding: 0; width: 100%; overflow: hidden;}        .spa-fullscreen {position: absolute; left: 0; top: 0; margin: 0; padding: 0; width: 100%; visibility: hidden; overflow: hidden; z-index: -1; }        .spa-page {position: absolute; left: 0; top: 0; bottom: 0; right: 0; margin: 0; padding: 0; overflow: hidden; z-index: 2000; }        .spa-page-bg {position: absolute; left: 0; top: 0; bottom: 0; right: 0; margin: 0; padding: 0; }        .spa-page-body {position: absolute; left: 0; top: 0; bottom: 0; right: 0; margin: 0; padding: 0; overflow: hidden; }        .spa-scroll {overflow: auto;}        .spa-scroll-touch {-webkit-overflow-scrolling: touch;}        .spa-scroll-x {overflow-y: hidden;}        .spa-scroll-y {overflow-x: hidden;}        .spa-cover {display: none; position: absolute; left: 0; right: 0; top: 0; bottom: 0; text-align: center; z-index: 5000; }        .spa-loader {display: none; position: absolute; left: 0; right: 0; top: 0; bottom: 0; text-align: center; overflow: hidden; z-index: 5001; }",F='<div class="spa-loader-animate"><span></span><span></span><span></span></div>',G=".spa-loader .spa-loader-animate {position: absolute; left: 50%; top: 50%; margin: -12px 0 0 -65px; }        .spa-loader .spa-loader-animate span { display: inline-block; vertical-align: middle; width: 10px; height: 10px; margin: 0 10px; background: black; border-radius: 50px; -webkit-animation: loader 0.9s infinite alternate; animation: loader 0.9s infinite alternate; }        .spa-loader .spa-loader-animate span:nth-of-type(2) { -webkit-animation-delay: 0.3s; -moz-animation-delay: 0.3s; }        .spa-loader .spa-loader-animate span:nth-of-type(3) { -webkit-animation-delay: 0.6s; -moz-animation-delay: 0.6s; }        @-webkit-keyframes loader {          0% { width: 10px; height: 10px; opacity: 0.8; -webkit-transform: translateY(0); }          100% { width: 24px; height: 24px; opacity: 0.1; -webkit-transform: translateY(-21px); }        }        @-moz-keyframes loader {          0% { width: 10px; height: 10px; opacity: 0.8; -moz-transform: translateY(0); }          100% { width: 24px; height: 24px; opacity: 0.1; -moz-transform: translateY(-21px);}}";a.spa={},a.spa.getViewData=function(a){return D[a.data("id")]},o.on("spa:addstyle",function(b,c){a('<style type="text/css">'+c+"</style>").appendTo(a("head"))}),function(){var a,b,c,d=function(){b=Math.max(n.height(),window.innerHeight),c=Math.max(n.width(),window.innerWidth),k.css({height:2*b}),window.scrollTo(0,0),i.data("innerHeight",window.innerHeight),b=Math.max(n.height(),window.innerHeight),k.height()!=b&&(i.css({width:c,height:b}),k.css({width:c,height:b}))};n.on("spa:adjustfullscreen resize orientationchange",function(){void 0!==a&&(cancelAnimationFrame(a),a=void 0),a=requestAnimationFrame(d)})}(),o.on("spa:scroll",function(b,c){var d=a(b.target),e=c&&c.direction||"";d.addClass("spa-scroll"+(e?" spa-scroll-"+e:""))}),o.on("spa:removescroll",function(b){var c=a(b.target);c.removeClass("spa-scroll")}),r&&o.on("touchstart",".spa-scroll, .spa-scroll-x, .spa-scroll-y",function(b){var c=a(b.currentTarget),d=c.prop("scrollTop"),e=c.prop("scrollLeft"),f=c.height(),g=c.width(),h=c.prop("scrollHeight"),i=c.prop("scrollWidth");(c.hasClass("spa-scroll")||c.hasClass("spa-scroll-x"))&&(0>=e&&c.prop("scrollLeft",1),e+g>=i&&c.prop("scrollLeft",i-g-1)),(c.hasClass("spa-scroll")||c.hasClass("spa-scroll-y"))&&(0>=d&&c.prop("scrollTop",1),d+f>=h&&c.prop("scrollTop",d-1))}),n.on("scroll",function(){var a=i.data("innerHeight");a&&a!==window.innerHeight&&n.trigger("spa:adjustfullscreen")}),n.on("unload",function(){i.html("")}),n.on("popstate",function(a){if(s){if(l&&"block"===l.css("display"))return!1;if(m&&m.hasClass("spa-panel")){var c=m.data("id"),d=D[c],e=d.prevPage;return e.trigger("spa:openpage"),!1}var f=b();if(!v.length||v[v.length-1]!==f){v.push(f);var g=A[f],h=a.state||{};if(j&&(h=j,j=void 0),g){var i=g.data("id"),k=D[i];k.oldpushData=k.pushData,k.pushData=h,g.trigger("spa:openpage")}else o.trigger("spa:createpage",{hash:f,pushData:h})}}});var H=/\((.*?)\)/g,I=/(\(\?)?:\w+/g,J=/\*\w+/g,K=/[\-{}\[\]+?.,\\\^$|#\s]/g,L={route:"",animate:"",classname:"",view:function(){return{title:"",body:""}},init:function(){},beforeopen:function(){},afteropen:function(){},beforeclose:function(){},afterclose:function(){}};o.on("spa:route",function(b,e){var f=Array.prototype.slice.call(arguments,1);if(f.length>1)return a.each(f,function(a,b){o.trigger("spa:route",b)}),!1;var g=e.route||"";c(g)||(g=d(g)),e.animate&&!a.isFunction(e.animate)&&R(e.animate)&&(e.animate=""),t[g]=a.extend({},L,e)});var M={},N={},O="transform",P="transition",Q="transitionend";!function(){var b,c={"-webkit-transition":["-webkit-transform","webkitTransitionEnd"],"-moz-transition":["-moz-transform","transitionend"],"-ms-transition":["-ms-transform","msTransitionEnd"],"-o-transition":["-o-transform","oTransitionEnd"],transition:["transform","transitionend"]},d=a("<div></div>").get(0);for(b in c)return void 0!==d.style[b]&&(P=b,O=c[b][0],Q=c[b][1]),void 0}(),a.fn.transition=function(b,c){var d=a(this);return requestAnimationFrame(function(){b[P]="0.4s",d.css(b).emulateTransitionEnd(function(){b={},b[P]="",d.css(b),c&&c()})}),d},a.fn.emulateTransitionEnd=function(b,c){var d,e=!1,f=a(this);c=c||416,f.one(Q,function(){e=!0,clearTimeout(d),b.call(f)});var g=function(){e||f.trigger(Q)};return d=setTimeout(g,c),f},M.defaultInOut=function(a,b,c){f(b,a),c()},o.on("spa:addTransitPageAnimates",function(b,c){var d=[];a.each(c,function(a){d.push(a)}),a.each(d,function(a,b){N[b]=a%2===0?d[a+1]:d[a-1]}),a.extend(M,c)}),o.trigger("spa:addTransitPageAnimates",{fadeIn:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),{opacity:0}),h={opacity:1};e.css(g),f(c,b),e.transition(h,function(){d()})},fadeOut:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g={opacity:0};e.transition(g,function(){f(c,b),d()})},fadeInLeft:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),{opacity:0}),h={opacity:1};g[O]="translate3d(100%, 0, 0)",h[O]="translate3d(0%, 0, 0)",e.css(g),f(c,b),e.transition(h,function(){d()})},fadeOutRight:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g={opacity:0};g[O]="translate3d(100%, 0, 0)",e.transition(g,function(){f(c,b),d()})},fadeInRight:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),{opacity:0}),h={opacity:1};g[O]="translate3d(-100%, 0, 0)",h[O]="translate3d(0%, 0, 0)",e.css(g),f(c,b),e.transition(h,function(){d()})},fadeOutLeft:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g={opacity:0};g[O]="translate3d(-100%, 0, 0)",e.transition(g,function(){f(c,b),d()})},fadeInUp:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),{opacity:0}),h={opacity:1};g[O]="translate3d(0, 100%, 0)",h[O]="translate3d(0, 0%, 0)",e.css(g),f(c,b),e.transition(h,function(){d()})},fadeOutDown:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g={opacity:0};g[O]="translate3d(0, 100%, 0)",e.transition(g,function(){f(c,b),d()})},fadeInDown:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),{opacity:0}),h={opacity:1};g[O]="translate3d(0, -100%, 0)",h[O]="translate3d(0, 0%, 0)",e.css(g),f(c,b),e.transition(h,function(){d()})},fadeOutUp:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g={opacity:0};g[O]="translate3d(0, -100%, 0)",e.transition(g,function(){f(c,b),d()})},slideInLeft:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),{}),h={};g[O]="translate3d(100%, 0, 0)",h[O]="translate3d(0%, 0, 0)",e.css(g),f(c,b),e.transition(h,function(){d()})},slideOutRight:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g={};g[O]="translate3d(100%, 0, 0)",e.transition(g,function(){f(c,b),d()})},slideInRight:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),{}),h={};g[O]="translate3d(-100%, 0, 0)",h[O]="translate3d(0%, 0, 0)",e.css(g),f(c,b),e.transition(h,function(){d()})},slideOutLeft:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g={};g[O]="translate3d(-100%, 0, 0)",e.transition(g,function(){f(c,b),d()})},slideInUp:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),{}),h={};g[O]="translate3d(0, 100%, 0)",h[O]="translate3d(0, 0%, 0)",e.css(g),f(c,b),e.transition(h,function(){d()})},slideOutDown:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g={};g[O]="translate3d(0, 100%, 0)",e.transition(g,function(){f(c,b),d()})},slideInDown:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),{}),h={};g[O]="translate3d(0, -100%, 0)",h[O]="translate3d(0, 0%, 0)",e.css(g),f(c,b),e.transition(h,function(){d()})},slideOutUp:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g={};g[O]="translate3d(0, -100%, 0)",e.transition(g,function(){f(c,b),d()})},pushInLeft:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=0,i={},j={},k={};i[O]="translate3d(100%, 0, 0)",j[O]="translate3d(0%, 0, 0)",k[O]="translate3d(-100%, 0, 0)",e.css(i),f(c,b),e.transition(j,function(){2==++h&&d()}),g.transition(k,function(){2==++h&&d()})},pushOutRight:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=0,i={},j={},k={};i[O]="translate3d(-100%, 0, 0)",j[O]="translate3d(0%, 0, 0)",k[O]="translate3d(100%, 0, 0)",e.css(i),f(c,b),e.transition(j,function(){2==++h&&d()}),g.transition(k,function(){2==++h&&d()})},pushInRight:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=0,i={},j={},k={};i[O]="translate3d(-100%, 0, 0)",j[O]="translate3d(0%, 0, 0)",k[O]="translate3d(100%, 0, 0)",e.css(i),f(c,b),e.transition(j,function(){2==++h&&d()}),g.transition(k,function(){2==++h&&d()})},pushOutLeft:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=0,i={},j={},k={};i[O]="translate3d(100%, 0, 0)",j[O]="translate3d(0%, 0, 0)",k[O]="translate3d(-100%, 0, 0)",e.css(i),f(c,b),e.transition(j,function(){2==++h&&d()}),g.transition(k,function(){2==++h&&d()})},pushInUp:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=0,i={},j={},k={};i[O]="translate3d(0, 100%, 0)",j[O]="translate3d(0%, 0, 0)",k[O]="translate3d(0, -100%, 0)",e.css(i),f(c,b),e.transition(j,function(){2==++h&&d()}),g.transition(k,function(){2==++h&&d()})},pushOutDown:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=0,i={},j={},k={};i[O]="translate3d(0, -100%, 0)",j[O]="translate3d(0%, 0, 0)",k[O]="translate3d(0, 100%, 0)",e.css(i),f(c,b),e.transition(j,function(){2==++h&&d()}),g.transition(k,function(){2==++h&&d()})},pushInDown:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=0,i={},j={},k={};i[O]="translate3d(0, -100%, 0)",j[O]="translate3d(0%, 0, 0)",k[O]="translate3d(0, 100%, 0)",e.css(i),f(c,b),e.transition(j,function(){2==++h&&d()}),g.transition(k,function(){2==++h&&d()})},pushOutUp:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=0,i={},j={},k={};i[O]="translate3d(0, 100%, 0)",j[O]="translate3d(0%, 0, 0)",k[O]="translate3d(0, -100%, 0)",e.css(i),f(c,b),e.transition(j,function(){2==++h&&d()}),g.transition(k,function(){2==++h&&d()})},zoomIn:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),{}),h={};g[O]="scale3d(0, 0, 0)",h[O]="scale3d(1, 1, 1)",e.css(g),f(c,b),e.transition(h,function(){d()})},zoomOut:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g={};g[O]="scale3d(0, 0, 0)",e.transition(g,function(){f(c,b),d()})},overlayInLeft:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),e.children().width()),h={left:"auto",width:g},i={};i[O]="translate3d(0px, 0, 0)",e.css(h),g=2*g-e.prop("clientWidth"),h={width:g},h[O]="translate3d("+g+"px, 0, 0)",e.css(h),f(c,b),e.transition(i,function(){d()})},overlayOutRight:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g=e.width(),h={},i={width:"auto",left:0};h[O]="translate3d("+g+"px, 0, 0)",e.transition(h,function(){f(c,b),e.css(i),d()})},overlayInRight:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),e.children().width()),h={right:"auto",width:g},i={};i[O]="translate3d(0px, 0, 0)",e.css(h),g=2*g-e.prop("clientWidth"),h={width:g},h[O]="translate3d("+(0-g)+"px, 0, 0)",e.css(h),f(c,b),e.transition(i,function(){d()})},overlayOutLeft:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g=e.width(),h={},i={width:"auto",right:0};h[O]="translate3d("+(0-g)+"px, 0, 0)",e.transition(h,function(){f(c,b),e.css(i),d()})},overlayInUp:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),e.children().height()),h={top:"auto",height:g},i={};i[O]="translate3d(0, 0px, 0)",e.css(h),g=2*g-e.prop("clientHeight"),h={height:g},h[O]="translate3d(0, "+g+"px, 0)",e.css(h),f(c,b),e.transition(i,function(){d()})},overlayOutDown:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g=e.height(),h={},i={height:"auto",top:0};h[O]="translate3d(0, "+g+"px, 0)",e.transition(h,function(){f(c,b),e.css(i),d()})},overlayInDown:function(b,c,d){var e=a(".spa-page-body",b),g=(a(".spa-page-body",c),e.children().height()),h={bottom:"auto",height:g},i={};i[O]="translate3d(0, 0px, 0)",e.css(h),g=2*g-e.prop("clientHeight"),h={height:g},h[O]="translate3d(0, "+(0-g)+"px, 0)",e.css(h),f(c,b),e.transition(i,function(){d()})},overlayOutUp:function(b,c,d){var e=(a(".spa-page-body",b),a(".spa-page-body",c)),g=e.height(),h={},i={height:"auto",bottom:0};h[O]="translate3d(0, "+(0-g)+"px, 0)",e.transition(h,function(){f(c,b),e.css(i),d()})},revealInLeft:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=e.children().width(),i={left:"auto",width:h},j={};i[O]="translate3d(0, 0, 0)",e.css(i),h=2*e.width()-e.prop("clientWidth"),e.css({width:h}),j[O]="translate3d("+(0-h)+"px, 0, 0)",f(b,c),g.transition(j,function(){f(c,b),d()})},revealOutRight:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=(g.width(),{});h[O]="translate3d(0px, 0, 0)",f(c,b),e.transition(h,function(){g.css({width:"auto",left:0}),d()})},revealInRight:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=e.children().width(),i={right:"auto",width:h},j={};i[O]="translate3d(0, 0, 0)",e.css(i),h=2*e.width()-e.prop("clientWidth"),e.css({width:h}),j[O]="translate3d("+h+"px, 0, 0)",f(b,c),g.transition(j,function(){f(c,b),d()})},revealOutLeft:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=(g.width(),{});h[O]="translate3d(0px, 0, 0)",f(c,b),e.transition(h,function(){g.css({width:"auto",right:0}),d()})},revealInUp:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=e.children().height(),i={top:"auto",height:h},j={};i[O]="translate3d(0, 0, 0)",e.css(i),h=2*e.height()-e.prop("clientHeight"),e.css({height:h}),j[O]="translate3d(0, "+(0-h)+"px, 0)",f(b,c),g.transition(j,function(){f(c,b),d()})},revealOutDown:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=(g.height(),{});h[O]="translate3d(0, 0px, 0)",f(c,b),e.transition(h,function(){g.css({height:"auto",top:0}),d()})},revealInDown:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=e.children().height(),i={bottom:"auto",height:h},j={};i[O]="translate3d(0, 0, 0)",e.css(i),h=2*e.height()-e.prop("clientHeight"),e.css({height:h}),j[O]="translate3d(0, "+h+"px, 0)",f(b,c),g.transition(j,function(){f(c,b),d()})},revealOutUp:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=(g.height(),{});h[O]="translate3d(0, 0px, 0)",f(c,b),e.transition(h,function(){g.css({height:"auto",bottom:0}),d()})},pushPartInLeft:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=e.children().width(),i=0,j={left:"auto",width:h},k={},l={};e.css(j),h=2*e.width()-e.prop("clientWidth"),j={width:h},j[O]="translate3d("+h+"px, 0, 0)",k[O]="translate3d(0px, 0, 0)",l[O]="translate3d("+(0-h)+"px, 0, 0)",e.css(j),f(c,b),e.transition(k,function(){2==++i&&d()}),g.transition(l,function(){2==++i&&d()})},pushPartOutRight:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=g.width(),i=0,j={},k={},l={width:"auto",left:0};j[O]="translate3d(0px, 0, 0)",k[O]="translate3d("+h+"px, 0, 0)",f(c,b),e.transition(j,function(){2==++i&&d()}),g.transition(k,function(){g.css(l),2==++i&&d()})},pushPartInRight:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=e.children().width(),i=0,j={right:"auto",width:h},k={},l={};e.css(j),h=2*e.width()-e.prop("clientWidth"),j={width:h},j[O]="translate3d("+(0-h)+"px, 0, 0)",l[O]="translate3d("+h+"px, 0, 0)",k[O]="translate3d(0px, 0, 0)",e.css(j),f(c,b),e.transition(k,function(){2==++i&&d()}),g.transition(l,function(){2==++i&&d()})},pushPartOutLeft:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=g.width(),i=0,j={},k={},l={width:"auto",right:0};j[O]="translate3d(0px, 0, 0)",k[O]="translate3d("+(0-h)+"px, 0, 0)",f(c,b),e.transition(j,function(){2==++i&&d()}),g.transition(k,function(){g.css(l),2==++i&&d()})},pushPartInUp:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=e.children().height(),i=0,j={top:"auto",height:h},k={},l={};e.css(j),h=2*e.height()-e.prop("clientHeight"),j={height:h},j[O]="translate3d(0, "+h+"px, 0)",k[O]="translate3d(0, 0px, 0)",l[O]="translate3d(0, "+(0-h)+"px, 0)",e.css(j),f(c,b),e.transition(k,function(){2==++i&&d()}),g.transition(l,function(){2==++i&&d()})},pushPartOutDown:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=g.height(),i=0,j={},k={},l={height:"auto",top:0};j[O]="translate3d(0, 0px, 0)",k[O]="translate3d(0, "+h+"px, 0)",f(c,b),e.transition(j,function(){2==++i&&d()}),g.transition(k,function(){g.css(l),2==++i&&d()})},pushPartInDown:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=e.children().height(),i=0,j={bottom:"auto",height:h},k={},l={};e.css(j),h=2*e.height()-e.prop("clientHeight"),j={height:h},j[O]="translate3d(0, "+(0-h)+"px, 0)",k[O]="translate3d(0, 0px, 0)",l[O]="translate3d(0, "+h+"px, 0)",e.css(j),f(c,b),e.transition(k,function(){2==++i&&d()}),g.transition(l,function(){2==++i&&d()})},pushPartOutUp:function(b,c,d){var e=a(".spa-page-body",b),g=a(".spa-page-body",c),h=g.height(),i=0,j={},k={},l={height:"auto",bottom:0};j[O]="translate3d(0, 0px, 0)",k[O]="translate3d(0, "+(0-h)+"px, 0)",f(c,b),e.transition(j,function(){2==++i&&d()}),g.transition(k,function(){g.css(l),2==++i&&d()})}});var R=function(){var a=/^(overlay|reveal|pushPart).*$/;return function(b){return a.test(b)}}(),S=function(){var a=0;return function(){return a++}}();o.on("spa:createpage",function(b,d){o.trigger("spa:openloader");var f,g,h,i=d.hash,j=d.pushData;if(a.each(t,function(a,b){return g=new RegExp(a),g.test(i)?(f=a,h=b,!1):(g=!1,void 0)}),c(g)){var k,l,m=h.classname?" spa-page-"+h.classname:"",n=a('<div class="spa-page'+m+'"><div class="spa-page-bg"></div><div class="spa-page-body"></div></div>'),p=S();n.data("id",p),k={id:p,hash:i,pushData:j,requestData:e(g,i),route:f,el:n},D[p]=k,n.appendTo(a("body")),o.trigger("spa:viewcache",{view:n}),l=h.view.call(n,k),a.isPlainObject(l)&&n.trigger("spa:initpage",l)}}),o.on("spa:initpage",".spa-page",function(b,c){var d=a(b.currentTarget),e=d.data("id"),f=D[e],g=t[f.route];a.each(["init","beforeopen","afteropen","beforeclose","afterclose"],function(a,b){c[b]&&(g[b]=c[b])}),f.viewData=c,a(".spa-page-body",d).html(c.body),g.init.call(d,f),d.trigger("spa:openpage"),o.trigger("spa:closeloader")}),o.on("spa:openpage",".spa-page",function(c,d){var e=a(c.currentTarget),f=e.data("id"),h=D[f],i=t[h.route],j=h.hash,k=h.pushData,l=(h.oldpushData,h.requestData,h.viewData),p=k.title||l.title,q=k.animate||i.animate;m||(m=a('<div class="spa-page spa-page-empty"><div class="spa-page-body"></div></div>').appendTo(a("body")));var r=m.data("id"),s=D[r]||{};if(!k.animate&&s.prevPage&&s.prevPage.data("id")===f){var v=s.prevAnimate;v&&!a.isFunction(v)&&(q=N[v])}var w,x;if(m.hasClass("spa-panel")){var y=u[m.data("id")];w=y.beforeclose,x=y.afterclose}else if(s.route){var z=t[s.route];w=z.beforeclose,x=z.afterclose,o.trigger("spa:navigate",{hash:j,title:p,pushData:k,replace:!0})}var A=function(){i.afteropen.call(e,h),a(".spa-scroll",m).removeClass("spa-scroll-touch"),x&&x.call(m,s),h.prevPage=m,m=e,h.hash!==b()?n.trigger("popstate"):a.isFunction(d)&&d.call(e)};a(".spa-scroll",e).addClass("spa-scroll-touch"),w&&w.call(m,s),i.beforeopen.call(e,h),h.prevAnimate=q,a.isFunction(q)?q(e,m,A):g(e,m,q,A),o.trigger("spa:viewcachesort",{view:e})});var T={id:"",animate:"",classname:"",view:function(){return{body:""}},init:function(){},beforeopen:function(){},afteropen:function(){},beforeclose:function(){},afterclose:function(){}};o.on("spa:panel",function(b,c){var d=Array.prototype.slice.call(arguments,1);return d.length>1?(a.each(d,function(a,b){o.trigger("spa:panel",b)}),!1):(c.id&&!u[c.id]&&(u[c.id]=a.extend({},T,c)),void 0)}),o.on("spa:createpanel",function(b,c,d){var e=u[c];if(e){o.trigger("spa:openloader");var f,g,h=e.classname?" spa-panel-"+e.classname:"",j=a('<div id="spa-panel-'+c+'" class="spa-page spa-panel '+h+'"><div class="spa-page-bg"></div><div class="spa-page-body"></div></div>');j.data("id",c),f={id:c,pushData:d,el:j},D[c]=f,j.appendTo(i),o.trigger("spa:viewcache",{view:j}),g=e.view.call(j,f),a.isPlainObject(g)&&j.trigger("spa:initpanel",g)}}),o.on("spa:initpanel",".spa-panel",function(b,c){var d=a(b.currentTarget),e=d.data("id"),f=D[e],g=f.pushData,h=u[e];a.each(["init","beforeopen","afteropen","beforeclose","afterclose"],function(a,b){c[b]&&(h[b]=c[b])}),f.viewData=c,a(".spa-page-body",d).html(c.body),h.init.call(d,f),d.trigger("spa:openpanel",[e,g]),o.trigger("spa:closeloader")}),o.on("spa:openpanel",function(b,c,d){if(l&&"block"===l.css("display"))return!1;var e=B[c];if(d||(d={}),e){var f=u[c],h=d.animate||f.animate;if(m.hasClass("spa-panel")){var i=D(m.data("id")),j=i.prevPage;return j.trigger("spa:openpage",[function(){o.trigger("spa:openpanel",[c,d])}]),!1}var k=D[c];k.oldpushData=k.pushData,k.pushData=d,a(".spa-scroll",e).addClass("spa-scroll-touch"),f.beforeopen.call(e,k);var n=function(){f.afteropen.call(e,k),k.prevPage=m,m=e};k.prevAnimate=h,a.isFunction(h)?h(e,m,n):g(e,m,h,n),o.trigger("spa:viewcachesort",{view:e})}else o.trigger("spa:createpanel",[c,d])}),o.on("spa:closepanel",function(b,c){var d=a(b.target),e=d.data("id"),f=D[e];if(c&&c.id&&(d=a(".spa-panel-"+c.id)),m.hasClass("spa-panel")&&m.data("id")===e){var g=f.prevPage;g.trigger("spa:openpage")}}),o.on("click touchstart",".spa-panel",function(b){var c=a(b.currentTarget),d=a(b.target);(d.hasClass("spa-page-bg")||d.hasClass("spa-panel"))&&(b.stopPropagation(),b.preventDefault(),c.trigger("spa:closepanel"))}),o.on("spa:viewcachecount",function(a,b){z=b.count}),o.on("spa:viewcache",function(b,c){var d,e,f=c.view,g=f.data("id");if(f.hasClass("spa-panel")?(d="panle",e=g,B[e]=f):(d="page",e=D[g].hash,A[e]=f),C.unshift(d+":"+e),0!==z&&C.length>z){var h,i,j,k,l=C.splice(z);a.each(l,function(a,b){h=b.split(":",2),i=h[0],j=h[1],k="page"==i?A:B,k[j].html("").remove(),delete k[j]})}}),o.on("spa:viewcachesort",function(a,b){var c,d,e,f,g=b.view,h=g.data("id");g.hasClass("spa-panel")?(c="panle",d=h):(c="page",d=D[h].hash),e=c+":"+d,f=C.indexOf(e),-1!==f&&(C.splice(f,1),C.unshift(e))}),o.on("spa:navigate",function(b,c){var d=c.hash||"",e=c.title||"",f=c.pushData||{},g=c.replace||!1;e&&(document.title=e),d="#"+d,g?q.replaceState(f,e,d):(q.pushState(f,e,d),!a.isEmptyObject(f)&&(j=f),n.trigger("popstate"))}),o.on("spa:loader",function(a,b){b.body&&(F=b.body),b.style&&(G=b.style)}),o.on("spa:openloader",function(){l.show()}),o.on("spa:closeloader",function(){l.hide()}),o.on("spa:boot",function(){i=a("body"),o.trigger("spa:addstyle",E),k=a('<div class="spa-fullscreen"></div>').prependTo(i),o.trigger("spa:adjustfullscreen"),o.trigger("spa:addstyle",G),l=a('<div class="spa-loader">'+F+"</div>").appendTo(a("body")),l.on("click select mousedown mousemove mouseup touchstart touchmove touchend",h),s=!0,n.trigger("popstate")})}(window.Zepto||window.jQuery||window.$),function(){"use strict";for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}();